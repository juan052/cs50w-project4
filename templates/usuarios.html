{% extends "layout.html" %}
{% block main %}
<div class="xp-breadcrumbbar text-center">
    <h4 class="page-title" style="background-color: #ef4444; color:black">Usuarios</h4>
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">Gestion de
                colaboradores</a></li>
        <li class="breadcrumb-item active"
            aria-current="page">Colaborades</li>
    </ol>
</div>

<div class="row">

    <div class="col-md-12">
        <div class="table-wrapper">
            <div class="table-title">
                <div class="row">
                    <div class="col-sm-6 p-0 d-flex
                        justify-content-lg-start
                        justify-content-center">
                        <h2 class="ml-lg-2">Gestion de
                            colaboradores</h2>
                    </div>
                    <div class="col-sm-6 p-0 d-flex
                        justify-content-lg-end
                        justify-content-center">
                        <a href="#addEmployeeModal"
                            class="btn btn-success"
                            data-toggle="modal">
                            <i class="material-icons">&#xE147;</i>
                            <span>Agregar Colaborador</span></a>
                    </div>
                </div>
            </div>
            <table class="table table-striped table-hover"
                id="datatable_users">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>Cedula</th>
                        <th>Direccion</th>
                        <th>Celular</th>
                        <th>Foto</th>
                        <th>Estado</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for trabajadores in trabajadores %}
                    <tr>
                        <td>{{ trabajadores.persona.nombre }}</td>
                        <td>{{ trabajadores.persona.persona_natural.apellido }}</td>
                        <td>{{ trabajadores.persona.persona_natural.cedula }}</td>
                        <td>{{ trabajadores.persona.direccion }}</td>
                        <td>{{ trabajadores.persona.celular }}</td>
                        <th> <img
                                src="/static/img/imagenes/{{trabajadores.foto}}"
                                alt width="50"></th>
                        <td>
                            {% if trabajadores.estado == 1 %}
                            Activo
                            {% elif trabajadores.estado == 2 %}
                            Inactivo
                            {% endif %}
                        </td>
                        <td>
                            <a href="#editEmployeeModal{{trabajadores.id}}"
                                class="edit" data-toggle="modal">
                                <i class="material-icons" data-toggle="tooltip"
                                    title="Edit">&#xE254;</i>
                            </a>
                            <a href="#deleteEmployeeModal{{trabajadores.id}}"
                                class="delete" data-toggle="modal">
                                <i class="material-icons" data-toggle="tooltip"
                                    title="Delete">&#xE872;</i>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}

                </tbody>
            </table>

        </div>
        <!-- Edit Modal HTML -->
        <div id="addEmployeeModal" class="modal fade">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <form action="/crear_usuarios" method="post"
                        enctype="multipart/form-data">
                        <div class="modal-header">
                            <h4 class="modal-title">Crear usuarios</h4>
                            <button type="button" class="close"
                                data-dismiss="modal"
                                aria-hidden="true">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Colaborador:</label>
                                <select name="id_persona" id="id_persona" class="form-control">
                                    {% for trabajador in trabajadores %}
                                      <option value="{{ trabajador.id_persona }}">{{ trabajador.persona.nombre }}</option>
                                    {% endfor %}
                                  </select>
                                  
                            </div>
                            <div class="form-group">
                                <label>Correo: </label>
                                <input type="text" name="correo"
                                    class="form-control"
                                    required>
                            </div>
                            <div class="form-group">
                                <label>Contraseña: </label>
                                <input type="password" name="contraseña"
                                    class="form-control"
                                    required>

                            </div>

                        </div>
                        <div class="modal-footer">
                            <input type="button" class="btn
                                btn-default"
                                data-dismiss="modal"
                                value="Cancel">
                            <input type="submit" class="btn
                                btn-success" value="Add">
                        </div>
                    </form>
                </div>
            </div>
        </div>
        {% for productos in producto %}
        <!-- Edit Modal HTML -->
        <div id="editEmployeeModal{{productos.id}}" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form action="/producto_actualizar/{{productos.id}}"
                        method="post" enctype="multipart/form-data">
                        <div class="modal-header">
                            <h4 class="modal-title">Editar producto</h4>
                            <button type="button" class="close"
                                data-dismiss="modal"
                                aria-hidden="true">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Categoria</label>
                                <select name="subcategoria" id
                                    class="form-control">
                                    {% for subcategoria in subcategorias %}
                                    <optgroup label="{{
                                        subcategoria.categoria.nombre }}">
                                        <option value="{{subcategoria.id}}" {%
                                            if subcategoria.id ==
                                            subcategoria.id %}selected{% endif
                                            %}>{{subcategoria.nombre}}</option>
                                    </optgroup>
                                    {% endfor %}
                                </select>

                            </div>

                            <div class="form-group">
                                <label>Nombre</label>
                                <input type="text" name="nombre"
                                    class="form-control"
                                    required value="{{productos.nombre}}">
                            </div>
                            <div class="form-group">
                                <label>descripcion</label>
                                <textarea name="descripcion"
                                    class="form-control"
                                    required>{{productos.descripcion}}</textarea>
                            </div>
                            <div class="form-group">
                                <label>Cantidad</label>
                                <input type="number" name="cantidad"
                                    class="form-control"
                                    required value="{{productos.cantidad}}">
                            </div>
                            <div class="form-group">

                                {% if productos.logo %}
                                <label>Foto anterior</label>
                                <img src="{{ url_for('static',
                                    filename='img/imagenes/' + productos.logo)
                                    }}" alt="Foto actual" width="50">
                                {% endif %}

                                <label>Foto nueva</label>
                                <input type="file" name="foto"
                                    class="form-control"
                                    value="/static/img/imagenes/{{productos.logo}}">
                            </div>
                            <div class="form-group">
                                <select name="estado" id
                                    class="form-control">
                                    <option value="1" {% if productos.estado ==
                                        1 %}selected{% endif %}>Activo</option>
                                    <option value="2" {% if productos.estado ==
                                        2 %}selected{% endif %}>Inactivo</option>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <input type="button" class="btn
                                btn-default"
                                data-dismiss="modal"
                                value="Cancel">
                            <input type="submit" class="btn
                                btn-info" value="Save">
                        </div>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}

        {% for productos in producto %}
        <!-- Delete Modal HTML -->
        <div id="deleteEmployeeModal{{productos.id}}" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form action="/eliminar_producto" method="post">
                        <div class="modal-header">
                            <h4 class="modal-title">Eliminar producto</h4>

                            <button type="button" class="close"
                                data-dismiss="modal"
                                aria-hidden="true">&times;</button>
                        </div>
                        <div class="modal-body">
                            <input type="number" name="id"
                                value="{{ productos.id }}" hidden>

                            <p>estas?</p>
                            <p class="text-warning"><small>This
                                    .</small></p>
                        </div>
                        <div class="modal-footer">
                            <input type="button" class="btn
                                btn-default"
                                data-dismiss="modal"
                                value="Cancel">
                            <input type="submit" class="btn
                                btn-danger"
                                value="Delete">
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div>
    {% endfor %}
    <!---footer---->

</div>
{% endblock %}