{% extends "layout.html" %}
{% block main %}
<div class="xp-breadcrumbbar text-center">
    <h4 class="page-title" style="color:black">Productos</h4>
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">Gestion de
                productos</a></li>
        <li class="breadcrumb-item active"
            aria-current="page">Productos</li>
    </ol>
</div>

<div class="row">

    <div class="col-md-12">
        <div class="table-wrapper">
            <div class="table-title">
                <div class="row">
                    <div class="col-sm-6 p-0 d-flex
                        justify-content-lg-start
                        justify-content-center">
                        <h2 class="ml-lg-2">Gestion de
                            productos</h2>
                    </div>
                    <div class="col-sm-6 p-0 d-flex
                        justify-content-lg-end
                        justify-content-center">
                        <a href="#addEmployeeModal"
                            class="btn btn-success"
                            data-toggle="modal">
                            <i class="material-icons">&#xE147;</i>
                            <span>Asignar precios</span></a>
                    </div>
                </div>
            </div>
            <table class="table table-striped table-hover"
                id="datatable_users">
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Precio actual</th>
                        <th>Precio anterior</th>
                        <th>Estado</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for productos in Precios %}
                    <tr>
                        <td>{{ productos.producto.nombre }}</td>
                        <td>{{ productos.precio_actual }}</td>
                        <td>{{ productos.precio_anterior }}</td>
                        <td>
                            {% if productos.estado == 1 %}
                            Activo
                            {% elif productos.estado == 2 %}
                            Inactivo
                            {% endif %}
                        </td>
                        <td>
                            <a href="#editEmployeeModal{{productos.id}}"
                                class="edit" data-toggle="modal">
                                <i class="material-icons" data-toggle="tooltip"
                                    title="Edit">&#xE254;</i>
                            </a>
                            <a href="#deleteEmployeeModal{{productos.id}}"
                                class="delete" data-toggle="modal">
                                <i class="material-icons" data-toggle="tooltip"
                                    title="Delete">&#xE872;</i>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}

                </tbody>
            </table>

        </div>
        <!-- Edit Modal HTML -->
        <div id="addEmployeeModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form action="/crear_precio" method="post"
                        enctype="multipart/form-data">
                        <div class="modal-header">
                            <h4 class="modal-title">Asignar precio</h4>
                            <button type="button" class="close"
                                data-dismiss="modal"
                                aria-hidden="true">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Producto: </label>
                                <select name="producto" id="producto"
                                    class="form-control">
                                    {% for productos in productos %}
                                    <optgroup
                                        label="{{ productos.subcategoria.categoria.nombre }}">
                                        <optgroup
                                            label="{{ productos.subcategoria.nombre }}">
                                            <option value="{{ productos.id }}">{{
                                                productos.nombre }}</option>
                                        </optgroup>
                                    </optgroup>

                                    {% endfor %}
                                </select>

                            </div>
                            <div class="form-group">
                                <label>Nuevo precio</label>
                                <input type="text" name="precio_actual"
                                    class="form-control"
                                    required>
                            </div>

                            <select name="estado" id
                                class="form-control">
                                <option value="1">Activo</option>
                                <option value="2">Inactivo</option>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <input type="button" class="btn
                                btn-default"
                                data-dismiss="modal"
                                value="Cancel">
                            <input type="submit" class="btn
                                btn-success" value="Asignar">
                        </div>
                    </form>
                </div>
            </div>
        </div>
        {% for productos in Precios %}
        <!-- Edit Modal HTML -->
        <div id="editEmployeeModal{{productos.id}}" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form action="/actualizar_precio/{{productos.id}}"
                        method="post" enctype="multipart/form-data">
                        <div class="modal-header">
                            <h4 class="modal-title">Editar precios</h4>
                            <button type="button" class="close"
                                data-dismiss="modal"
                                aria-hidden="true">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Producto: </label>
                                <input type="text" value="{{productos.id_producto}}" hidden>
                                <input type="text" class="form-control" value="{{productos.producto.nombre}}" disabled>
                            </div>

                           
                            <div class="form-group">
                                <label>Nuevo precio</label>
                                <input type="number" name="precio_actual"
                                    class="form-control"
                                     value="" required>
                                <input type="number" name="precio_anterior"
                                    class="form-control"
                                     value="{{productos.precio_actual}}" hidden>
                            </div>
                           
                            <div class="form-group">
                                <select name="estado" id
                                    class="form-control">
                                    <option value="1" {% if productos.estado ==
                                        1 %}selected{% endif %}>Activo</option>
                                    <option value="2" {% if productos.estado ==
                                        2 %}selected{% endif %}>Inactivo</option>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <input type="button" class="btn
                                btn-default"
                                data-dismiss="modal"
                                value="Cancel">
                            <input type="submit" class="btn
                                btn-info" value="Save">
                        </div>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}

        {% for productos in producto %}
        <!-- Delete Modal HTML -->
        <div id="deleteEmployeeModal{{productos.id}}" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form action="/eliminar_producto" method="post">
                        <div class="modal-header">
                            <h4 class="modal-title">Eliminar producto</h4>

                            <button type="button" class="close"
                                data-dismiss="modal"
                                aria-hidden="true">&times;</button>
                        </div>
                        <div class="modal-body">
                            <input type="number" name="id"
                                value="{{ productos.id }}" hidden>

                            <p>estas?</p>
                            <p class="text-warning"><small>This
                                    .</small></p>
                        </div>
                        <div class="modal-footer">
                            <input type="button" class="btn
                                btn-default"
                                data-dismiss="modal"
                                value="Cancel">
                            <input type="submit" class="btn
                                btn-danger"
                                value="Delete">
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div>
    {% endfor %}
    <!---footer---->

</div>
{% endblock %}